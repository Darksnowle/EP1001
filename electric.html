<!DOCTYPE html>
<html>
	<head>
		<title>Fadhli's Website</title>
        <link rel="stylesheet" type="text/css" href="style3.css" />
	</head>

	<body>
		<div id="container"> 
            <div id="header">
                <h1>>Electronics Production</h1>
            </div>
        
        <div id="content">
            <div id="nav">
                <h2>Navigation</h2>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About Me</a></li>
                        <li><a href="info.html">Module Schedule</a></li>
                        <li><a href="safety.html">FabLab Safety</a></li>
                        <li><a class="selected" href="electric.html">Electronics Production</a></li>
                        <li><a href="electronicdes.html">Electronics Design</a></li>
                        <li><a href="program.html">Embedded Programming</a></li>
                        <li><a href="2d.html">2D Computer Controlled Machining</a></li>
                        <li><a href="moldncast.html">Molding & Casting</a></li>
                        <li><a href="application.html">Interface & Applications Programming</a></li>
                        <li><a href="final.html">Final Project</a>
                            <ul>
                                <li><a href=progress.html>Progress</a></li>
                            </ul>
                        </li>
                    </ul>
                
            </div>
                  <div id="main">
                     
                  <h1><u>Electronics Production</u></h1>
                      <p>For the start of my Further Digital Fabrication and Prototyping(FDFAB) journey, we were introduced to CNC Machines, and also Printed Circuit Boards (also known as PCB). Previously, we were able to create our own design/creations with the use of an arduino, a microcontroller, where we can easily programme through its own software and connect other input and output devices to it. As for PCBs, we have to actually come up with our own board designs, before we are able to programme and add any devices to it.</p>
                      
                    <h2>Printed Circuit Boards (PCB)</h2>
                      <p>So what is a PCB? A PCB mechanically supports and electrically connects electrical or electronic components using conductive tracks, pads and other features etched from one or more sheet layers of copper laminated onto and/or between sheet layers of a non-conductive substrate. <b>Why</b> do we make PCBs? When we create our own PCBs, we are able to customize the electronics to meet product requirements, the footprint of product, theres a greater reliability, ability to prototype and iterate faster and last but not least, it provides a better product integration. The first PCB that we were taught was called the <b>In-System Programer(ISP)</b> board.</p>
                      
                      <h2>In-System Programer(ISP)</h2>
                      <p>An ISP also called in-circuit serial programming is the ability of some programmable logic devices, microcontrollers, and other embedded devices to be programmed while installed in a complete system, rather than requiring the chip to be programmed prior to installing it into the system. It allows firmware updates to be delivered to the on-chip memory of microcontrollers and related processors without requiring specialist programming circuitry on the circuit board, and simplifies design work. <a href=https://en.wikipedia.org/wiki/In-system_programming target="_blank">(Source: Wikipedia)</a></p>
                      
                      <h2>Individual Assignment</h2>
                      
                      <p>For our first individual assignment, we were tasked to convert 2 PNG images of a ISP board, as seen below, to Gcode to be milled by the CNC machine. Before we generate the Gcode, we were first told on the the different parameters or settings that were needed to do for our traces and outlines. The table is also shown below.</p>
                      
                      <a href="images/electricprod/outline.png"><img src="images/electricprod/outline.png" width=300></a>
                      <a href="images/electricprod/traces.PNG"><img src="images/electricprod/traces.PNG" width=300></a>
                      
                      <h3>Recommended settings for Stepcraft</h3>
                      <table border=2 width=800>
                         <tr>
                            <th>Operation</th>
                            <th>Endmill size</th>
                            <th>Cut Speed</th>
                            <th>Cut Depth</th>
                            <th>Total Depth</th>
                            <th>Offset</th>
                         </tr>
                         
                         <tr>
                            <td>Traces</td>
                            <td>0.4 mm flat</td>
                            <td>50 ~ 60 mm/min</td>
                            <td>0.04 ~ 0.05 mm</td>
                            <td>0.04 ~ 0.05 mm</td>
                            <td>2 ~ 4</td>
                         </tr>
                         
                         <tr>
                            <td>Traces</td>
                            <td>0.8 mm flat</td>
                            <td>60 ~ 80 mm/min</td>
                            <td>0.04 ~ 0.05 mm</td>
                            <td>0.04 ~ 0.05 mm</td>
                            <td>1 ~ 2</td>
                         </tr>
                         
                         <tr>
                            <td>Traces</td>
                            <td>0.1 mm 30 deg V-bit</td>
                            <td>50 ~ 60 mm/min</td>
                            <td>0.04 ~ 0.05 mm</td>
                            <td>0.04 ~ 0.05 mm</td>
                            <td>1 ~ 2</td>
                         </tr>
                         
                         <tr>
                            <td>Board Outline</td>
                            <td>0.8 mm flat</td>
                            <td>50 ~ 80 mm/min</td>
                            <td>0.42 ~ 0.45 mm</td>
                            <td>1.65 ~ 1.70 mm</td>
                            <td>1</td>
                         </tr>
                      </table>
                      
                      <h2>Gcode Generation</h2>
                      <p>To generate the Gcode, we first have to go to <a href=https://fabfoundation.github.io/mods>Mods</a>. Once we are on that page, all we have to do is right click anywhere on the page to bring up a menu, which we then have to press <b>Programs > Open Programs</b>. Then just scroll down until you see <b>G-code</b>, scroll down further and click on <b>mill 2D PCB</b>. This will bring up the the setup page where you can input the different parameters and the actual PNG image.</p>
                      
                      <p>On this page, the first thing we have to do is obviously inserst the PNG image. For a demo, i will be first doing the traces. Once that is done, ensure that the <b>DPI</b> setting is set to 1000. Once that is done, i can then go ahead and input the respective parameters as seen in the table above. Next i adjusted the speed settings to 50 for the <b>cut</b> and <b>plunge</b> speed. The final settings should look like the one seen below. Once al that is done, we can go ahead and press calculate to download the Gcode and view to see the path of the drill bit.</p>
                      
                      <a href="images/electricprod/mods.PNG"><img src="images/electricprod/mods.PNG" width=800></a>
                      
                      <p>When that is done, we can then do the same for the outline but keep in mind that the parameters are different. After we've generated the Gcode, we were then introduced to a machine called the CNC machine. </p>
                      
                      <a href="images/electricprod/cnc.jpeg"><img src="images/electricprod/cnc.jpeg" width=800></a>
                      
                      <p>In order to operate the CNC machine, we first have to ofcourse load our Gcode files on the laptop which is located beside the machine. To do so, simply click on <b>Load File</b>, and find the traces file. Once that is done, take a copper board, cover the non copper side of the board with double sided tape and place it on the protective layer on the machine. Once that is done, we then have to place a copper board on the sacrificial layer. The copper or shiny part of the board should be on top and below, we have to cover the board up with double sided tape and paste it on the sacrificial layer. Then on the laptop, use the <b>arrow keys</b> the control the <b>X and Y axis</b> of the machine and the <b>Page-Up and Page-Down</b> to control the <b>Z axis</b>. We <b>first</b> have to check if the <b>Probe</b>, the button on the machine, is working, by pressing on the <b>Diagnostics</b> and press on the probe to see if the probe lights up on screen. If it does means it is working. Once that is done, we can then go ahead and install a 30 degree V-bit and the calibrate the X and Y followed by the Z axis by using the probe.</p>
                      
                      <a href="images/electricprod/laptop.jpg"><img src="images/electricprod/laptop.jpg" width=800></a><br>
                      <i>Photo of the laptop</i>
                      
                      <p>After calibrating, we can go ahead and turn on the machine but pushing down the button, and pressing on cycle start. Once the cutting of the traces is done, we can then go ahead and load the outline file, and recalibrate the Z axis, leaving the X and Y axis as it is. Before cutting it out though, we first have to change the bit to a flat end-mill so cut through to copper board. The end product should look something like the one below:</p>
                      
                      <a href="images/electricprod/helloworldboard.jpeg"><img src="images/electricprod/helloworldboard.jpeg" width=500></a>
                      <a href="images/electricprod/tracescut.jpg"><img src="images/electricprod/tracescut.jpg" width=500></a><br>
                      
                      <h2>Soldering</h2>
                      
                      <a href="images/electricprod/boardcomp.jpg"><img src="images/electricprod/boardcomp.jpg" width=500></a>
                      <a href="images/electricprod/pcb_full.png"><img src="images/electricprod/pcb_full.png" width=500></a>
                      
                      <p>For soldering, those are the components that are needed, and also where each components go to.</p>
                      
                      <p>Before i solder, i used a pen knife to remove excess copper except the threads, then i put on some flux before soldering on the components. The end result looks as such. I also connected it to my laptop after using a DMM to check if my connections and solder are well done.</p>
                      
                      <a href="images/electricprod/attiny85.jpeg"><img src="images/electricprod/attiny85.jpeg" width=500></a>
                      <a href="images/electricprod/boardinlap.jpeg"><img src="images/electricprod/boardinlap.jpeg" width=500></a>
                      
                      <h2>Troubleshooting</h2>
                      <p>After soldering my board and using a DMM to test it out, I found out that there is a problem. The problem that i came across was that i soldered the LED incorrectly. The red and the green ones are at the wrong position. Since my current board already looks bad due to the amount of solder, i decided to cut a new board and resoldered everything. The second board looks way better than the first one as seen below. I checked it properly and found out that everything is working properly.</p>
                      
                      <a href="images/electricprod/program.jpg"><img src="images/electricprod/program.jpg" width=500></a>
                      
                      <h2>Programming</h2>
                      <p>To program my programmer board, i first need to find a working programmer board. I know it sounds ridiculous but its true. I need a board to transmit programs to MY board in order for my board to work. For my case, I used Mr Chew's (my lecturer) board.</p> 
                      
                      <ol>
                          
                          <li><b>Software Download</b><br>
                              
                              Before i could do anything, i have to install some softwares.
                      <ul>
                        <li><b><u>AVR8 GNU Toolchain</u></b></li>
                        <li><b><u>GNU Make</u></b></li>
                        <li><b><u>AVRdude</u></b></li>
                        <li><b><u>Zadig</u></b></li>
                        <li><b><u>fts software</u></b></li>
                      </ul>
                      <p>All these softwares are available at <a href="https://carlossilesblog.wordpress.com/2016/05/18/install-atmel-avr-toolchain">Carlos Siles Projects</a> site.</p></li>
                          
                          <li>
                            <b>Environment Variable</b><br>
                              
                            Once installed, we first have to set the different paths. To do that, all you have to do is simply <b>Control Panel > System and Security > System > Advanced Settings > Environment Variables</b>. Once there, click on the PATH, and add the different paths as shown below.<br>
                              
                            <a href="images/electricprod/environ.png"><img src="images/electricprod/environ.png" width=500></a>
                            <a href="images/electricprod/path.png"><img src="images/electricprod/path.png" width=500></a>
                          </li>
                          
                          <li>
                            <b>Programming</b>
                              
                            Once that is done, we can start programming. To do that, just get your command prompt by typing <b>CMD</b> at your windows search bar. Next you need to find you need to find your <b>fts software</b> folder. To do so, just type <b>cd</b> on your command prompt, followed by your folder path, as seen below. Next you need to edit your <b>Makefile</b>folder if you are using a different type of chip. For me since im using a tiny 85, i will change 45 to 85. Once that is done, i can go ahead and do the command <b>make</b>. After command is completes, a file called fts_firmware.hex will be generated.<br>
                              
                            <a href="images/electricprod/fts.png"><img src="images/electricprod/fts.png" width=500></a>
                            <a href="images/electricprod/edit.png"><img src="images/electricprod/edit.png" width=500></a>
                            <a href="images/electricprod/make.png"><img src="images/electricprod/make.png" width=500></a><br>
                              
                            Next, run <b>make flash</b>, this command will erase the target chip, and program the flash memory with the contents of the .hex file built. You should see several progress bars while avrdude erases, programs, and verifies the chip.<br>
                              
                            <a href="images/electricprod/flash.png"><img src="images/electricprod/flash.png" width=500></a><br>
                              
                            After programmed the flash memory, the next thing is to set the configuration fuses. First, set the fuses that control where the microcontroller gets its clock source from, because the board works as a USB device and it requires the clock to come from the PLL. 

                            Confirmed that USB works, set the fuse that disables the reset pin and turns it into a regular GPIO pin, i.e. letting the chip use the reset pin to program other boards, but will disable the ability for this chip to be programmed. Run the make fuses command. This will set up all of the fuses except the one that disables the reset pin.<br> 

                            <a href="images/electricprod/fuses.png"><img src="images/electricprod/fuses.png" width=500></a><br>
                              
                            <h3>Check USB Functionality</h3>
                              
                            Now, the USB should be detected if you were to connect your own board to your computer. If not, all you have to do is use <b>Zadig</b>, and and make sure that it is selected as shown below, then click on install.<br>
                              
                            <a href="images/electricprod/zadig.png"><img src="images/electricprod/zadig.png" width=500></a><br>
                              
                            Once that is done, head on to device manager and see if your board is detected. If it is, it should be shown as such.<br>
                              
                            <a href="images/electricprod/devicem.png"><img src="images/electricprod/devicem.png" width=500></a><br>
                              
                            The final steps to turn your board into a working ISP programmer is firstly you need to change the bit that will turn the ATtiny45's reset pin into a GPIO pin, this will disable the ability for this chip to be programmed. When everything is working, connect the working AVR programmer to my board for the last time and run <b>make rstdisbl</b>. This is similar to make fuses command, and include that reset disable bit. After executing, avrdude will never be able to talk to this chip again through the ISP header. 
                              
                            <a href="images/electricprod/reset1.png"><img src="images/electricprod/reset1.png" width=500></a><br>
                              
                            <b>Final step!!</b>
                              
                            Once all that is done, i just execute the program as shown below after connecting my programmer board to my target board. If all goes well, your command prompt should look as such.
                              
                            <a href="images/electricprod/final.png"><img src="images/electricprod/final.png" width=500></a><br>
                              
                          </li>
                      </ol>
                      
                      
            </div>
        </div>
        
        <div id="footer">
            Copyright &copy; 2020 Muhd Fadhli
        </div>
        </div>
	</body>
</html>